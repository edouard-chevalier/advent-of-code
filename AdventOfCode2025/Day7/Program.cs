// See https://aka.ms/new-console-template for more information


using Template;

const string inputReal = @"......................................................................|......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.^...^...................................................................
.............................................................................................................................................
..................................................................^.^.^.^.^..................................................................
.............................................................................................................................................
.................................................................^.^.^...^.^.................................................................
.............................................................................................................................................
................................................................^.^.^...^.^.^................................................................
.............................................................................................................................................
...............................................................^...^...^.^.^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^...^...^.^.^..............................................................
.............................................................................................................................................
.............................................................^.^.^...^.^...^.^.^.............................................................
.............................................................................................................................................
............................................................^.....^.^.^.^.^.^.^.^............................................................
.............................................................................................................................................
...........................................................^...^.^...^.^...^...^.^...........................................................
.............................................................................................................................................
..........................................................^.^.^.^.^...^...^.^.....^..........................................................
.............................................................................................................................................
.........................................................^.^.^...^.^.^...^...^.....^.........................................................
.............................................................................................................................................
........................................................^.^.....^.^.^.^.^.^.^.^.^...^........................................................
.............................................................................................................................................
.......................................................^...^.^.^.^.^...^...^.^...^.^.^.......................................................
.............................................................................................................................................
......................................................^.^.^.^...^.......^...^.....^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.....................................................
.............................................................................................................................................
....................................................^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^.^....................................................
.............................................................................................................................................
...................................................^.^.....^.^.^...^...^.^.^.^...^.......^...................................................
.............................................................................................................................................
..................................................^...^.......^.....^...^.^.^.^.^.^...^...^..................................................
.............................................................................................................................................
.................................................^.^.^.....^.^.^.^...^.^...^.^.^.^.^...^.^.^.................................................
.............................................................................................................................................
................................................^.^.^...^.^...^.^.......^...^...^.^.^.^.^.^.^................................................
.............................................................................................................................................
...............................................^.........^...^.^.......^.....^.^.^...^.^.^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^.^...^.^.....^...^.^.^...^...^.^...^.^.^..............................................
.............................................................................................................................................
.............................................^...^.^.^.......^.....^.^.^.^...^.^.....^.^.....^.^.............................................
.............................................................................................................................................
............................................^...^...^.^.^...^...^.^.^...^...^.....^.^.^.^.^.^.^.^............................................
.............................................................................................................................................
...........................................^.....^...^.....^...^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...........................................
.............................................................................................................................................
..........................................^.^.^...^...^.^.....^...^.......^.^...^.^.^.^...^.^...^.^..........................................
.............................................................................................................................................
.........................................^.^.^...^...^.^.^.^...^.^...^.^.^.^...^.....^.^.^.^.^...^.^.........................................
.............................................................................................................................................
........................................^.^.^...^...^.^.^.^.....^.^.......^.....^...^.^.^.^.^.....^.^........................................
.............................................................................................................................................
.......................................^.^.^...^.^.^...^.^.^.^.^.^...^.^...^.^.^.........^.^.^.....^.^.......................................
.............................................................................................................................................
......................................^.^.^...^.....^.^.^.^.....^...^.......^.^.....^.^.^...^...^...^.^......................................
.............................................................................................................................................
.....................................^.^.^.^...^.....^.....^.^.^.^.....^.^.^.....^.^...............^...^.....................................
.............................................................................................................................................
....................................^.^.^.^.....^.^.^...^...^.....^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^....................................
.............................................................................................................................................
...................................^...^.^...^.....^.^...^...^.^.^.^...^...^.....^.....^.^...^.^.^...^.^.^...................................
.............................................................................................................................................
..................................^.^.^.^.......^...^.^.^.^...^.....^.^...^.^.^...^.^.^.^.^.^.^...^.^...^.^..................................
.............................................................................................................................................
.................................^.....^.^.^.....^.....^.^.^.^.^.^...^.........^.^.^.^.^.....^...^.^.^.^...^.................................
.............................................................................................................................................
................................^.^.^.^.^.^.^.^...^.^.......^.^.....^.^.^.^...^...^.^.^.......^...^.......^.^................................
.............................................................................................................................................
...............................^.^...^.^...^...^.^.^.^.^...^.^...^.^...^...^...^...^.^.^.^.^.^...^...^.^...^.^...............................
.............................................................................................................................................
..............................^.^...^.^...^...^...^.^.^.^...^...^.^.....^.^...^.^.^...^.^.^.^...^.^.^.^.^.^.^.^..............................
.............................................................................................................................................
.............................^.^.........^.^.^.....^.^.^...^.^.^.^.^.^.^...^...^.^...^...^.^.....^.^.^.^.^.^.^.^.............................
.............................................................................................................................................
............................^.^.^...^...^.^.....^.......^...^.^...^...^.^.....^...^.^.....^.^.^...^.^.^.^.^.....^............................
.............................................................................................................................................
...........................^.^.^...^.^...^.^.^...^.^.^.^.^...^.^.^...^.^.^.^.....^...^...^.^...^...^.^.^...^.^.^.^...........................
.............................................................................................................................................
..........................^...^.......^.^.^.^.^.....^.^.....^.^.^.^.^.^...^.^.......^.^...^.^.^...^...^...^.^.^...^..........................
.............................................................................................................................................
.........................^.^.^.^.^...^...^.^.^.^...^.^...^...^...^.^.^.^.^.^.....^...^.^.^.^.^.^.^.....^.^.^.^.....^.........................
.............................................................................................................................................
........................^.^...^.^.^.^.^.^.....^.^.^.^.^...^.^.^...^.^.....^.^.....^...^.....^.^.^.^.^.^.^.^.^.....^.^........................
.............................................................................................................................................
.......................^.^.^.^.....^.^.....^.^...^.^...........^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.......................
.............................................................................................................................................
......................^.^.^...^.^...^.^.^.^.^.^.........^.....^.^.....^.^.^.^...^...^...^.^.^.^.^.^.^...^.^.......^.^.^......................
.............................................................................................................................................
.....................^.^.^...^.^...^...^.....^.^.^...^.^.^...^.^...^...^...^.^.^.^.^...^.^...^.^.^...^...^.^.^.^.^.....^.....................
.............................................................................................................................................
....................^.^.....^.....^.^.^.^.^.^.^.^.^.^...^...^.^.....^.^.^.^...^...^...^.^.^.^.^...^.^.....^.^...^...^.^.^....................
.............................................................................................................................................
...................^.^...^...^...^.^.........^...^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.^.^...^...^.^.^.^...^.^...................
.............................................................................................................................................
..................^.^.....^.^.^.....^...^.^.^.^.^.^...^.^.....^.^...^...^.^.^...^.^...^.^.^.^.^...^...^.^...^.^.^.^.^...^.^..................
.............................................................................................................................................
.................^...^.^...^.^.^...^.....^.^.^.^...^...^...^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.....^...^.^...^...^.^...^.^...^.................
.............................................................................................................................................
................^.......^.^.^...^.^.....^.^.....^...^...^.........^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^...^...^.^.^.^.^................
.............................................................................................................................................
...............^.^.^.^...^.^...^.^.^.^.......^.^.....^.^.^.^.^.^.^.^.^.....^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^...^...^.^...............
.............................................................................................................................................
..............^.^.....^...^...^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^...^.....^...^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^..............
.............................................................................................................................................
.............^.^.^.^.^.^.....^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^...^.^.......^...^.^.^.^.....^.^.^.^.^.^.^.....^.^.^.^.............
.............................................................................................................................................
............^...^...^.^.^.......^.^.^...^...^...^.^.^.^...^.^.^.^.....^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.....^.^...^.^.^............
.............................................................................................................................................
...........^.^.......^.^.^.^.......^.^.^...^...^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^.....^.^...^.^.^.....^.^.^.^...^.^...^.^.^...^.^...........
.............................................................................................................................................
..........^.^...^...^.....^.^.......^.^.^.^.^.^.^.^.^.^...^.^.^.^.....^...^.^.....^.^.^...^.^.....^.......^...^.^.^...^.^.^.^.^.^.^..........
.............................................................................................................................................
.........^...^.^.^.^.......^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.......^.^.^...^.^...^.^...^.....^...^.^.^...^.....^.^...^.^.^.^.........
.............................................................................................................................................
........^.^.......^.^.^.^.^.^...^.....^...^.......^.^.^.^...^.^...^.....^.....^.^.....^.^.^.......^.^.^.^.^.....^...^.^...^.^.^.^.^.^........
.............................................................................................................................................
.......^.^.^.^.......^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^...^.^.^.^.^.^...^.^...........^.^...^.^...^.^.....^.^.^.......^.^.^...^.^.^.......
.............................................................................................................................................
......^.^...^.^...^.^.^.^.....^...^.^...^.....^.^...^.^.^.....^.^.^.........^.....^.^.....^.^.^.^.^.^...^.^.^...^...^.....^.^.^.^.^.^.^......
.............................................................................................................................................
.....^.^.....^.^.^.^.^.^.^...^.^...^...^...^.^.^.....^.^...^.....^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.....^.^.^.^.....^.^...^.^.^...^.....
.............................................................................................................................................
....^.^...^.^...^.^.^.^.^.^.^.^.....^...^.......^.^.^.^.^...^.......^.^.^.^.......^.............^.^.^.^.^.^.^...^.^.^.^.....^.^.^.^.....^....
.............................................................................................................................................
...^.^.^.^.^.^.^.^.^.^.^.^...^...^.^...^...^.^.^.^...^.^.^.^.^.^.^...^.^.^...^.....^.^.^.^.^.^.^.^.^.^...^.^...^.^.^.^.....^.^...^.....^.^...
.............................................................................................................................................
..^...^.^.^.^.^...^.^.^.^...^...^...^.^.....^...^.....^.^.....^.^.^...^.^.^...^.^...^...^...^.^.^...^.^...^.^.....^.^...^.^.....^...^...^.^..
.............................................................................................................................................
.^.^.......^...^.^...^.^...^.^...^.^.^.^.^.........^.^.......^.^.^.......^.^.^.^.^.^...^.^...^.^.......^.....^.^.^.^.^.^.^.^...^...^.^...^.^.
.............................................................................................................................................";

static string Load() {
    return File.ReadAllText(Path.Combine("D:\\code\\advent-of-code\\AdventOfCode2025\\data", $"{inputReal}.txt"));
}

const string inputTest = @".......|.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
...............";

void Part1(string input) {
    if (input.StartsWith("day")) {
        input = Load();
    }
    var grid = input.Split(Environment.NewLine).Select(s => s.ToArray()).ToArray();

    int res = 0;
    for (int i = 1; i < grid.Length; i++) {
        var above = grid[i - 1];
        var line = grid[i];
        for (int j = 0; j < line.Length; j++) {
            if (above[j] != '|') {
                continue;
            }

            if (line[j] == '.') {
                line[j] = '|';
            }
            else if (line[j] == '^') {
                res++;
                grid.TrySetCell(i, j - 1, '|');
                grid.TrySetCell(i, j + 1, '|');
            }
        }
    }
    Console.WriteLine(res);
}

void Part2(string input) {
    if (input.StartsWith("day")) {
        input = Load();
    }
    var grid = input.Split(Environment.NewLine).Select(s => s.ToArray()).ToArray();
    var counts = new long[grid.Length][];
    counts[0] = new long[grid[0].Length];
    counts[0][grid[0].IndexOf('|')] = 1;

    for (int i = 1; i < grid.Length; i++) {
        var above = grid[i - 1];
        var line = grid[i];
        var lineCount = ( counts[i] = new long[grid[i].Length]);
        for (int j = 0; j < line.Length; j++) {
            if (above[j] != '|') {
                continue;
            }

            var aboveCount = counts[i - 1][j];
            
            if (line[j] == '^') {
                grid[i][j - 1] = '|';
                lineCount[j - 1] += aboveCount;
                    
                grid[i][j + 1] = '|';
                lineCount[j + 1] += aboveCount;

            }
            else {
                line[j] = '|';
                lineCount[j] += aboveCount;
            }
        }
    }
    Console.WriteLine(counts[^1].Sum());
}

Part2(inputReal);